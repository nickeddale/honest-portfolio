<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Track the opportunity cost of your stock purchases">
    <meta name="theme-color" content="#3b82f6">
    <title>Honest Portfolio</title>

    <!-- Favicon -->
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon">

    <!-- PWA -->
    <link rel="manifest" href="/static/manifest.json">
    <link rel="apple-touch-icon" href="/static/icons/icon-192.png">

    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="/static/css/styles.css">

    <!-- RetroUI Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-[var(--background)] min-h-screen">
    <div id="app" class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <header class="mb-8 flex items-start justify-between gap-4">
            <div class="flex-1">
                <h1 class="text-3xl font-bold text-gray-800">Honest Portfolio</h1>
                <p class="text-gray-600">Track the opportunity cost of your stock purchases</p>
                <p class="text-gray-500 text-sm mt-2 max-w-2xl">Enter your stock purchases and see how they would have performed if you had invested the same amount in benchmark stocks like SPY, AAPL, or NVDA instead. Compare your actual returns against what could have been.</p>
            </div>

            <!-- Guest login section (shown to non-authenticated users) -->
            <div id="guest-login-section" class="hidden flex items-center gap-3">
                <span class="text-sm text-[var(--muted-foreground)]">Guest Mode</span>
                <button class="google-signin-btn bg-[var(--primary)] text-[var(--primary-foreground)] border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all text-sm">
                    Sign In
                </button>
            </div>

            <!-- User Profile (hidden until logged in) -->
            <div id="user-section" class="hidden flex items-center gap-4">
                <div class="flex items-center gap-2">
                    <div id="user-avatar" class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white text-sm font-medium overflow-hidden">
                        <span id="user-initials"></span>
                        <img id="user-picture" class="hidden w-full h-full object-cover" alt="Profile">
                    </div>
                    <span id="user-name" class="text-sm text-gray-700 hidden sm:inline"></span>
                </div>
                <button id="logout-btn" class="text-sm text-gray-500 hover:text-gray-700 flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                    </svg>
                    Logout
                </button>
            </div>
        </header>

        <!-- Guest signup prompt (shown after guest adds a purchase) -->
        <div id="guest-signup-prompt" class="hidden bg-[var(--secondary)] border-b-4 border-[var(--border)] p-4">
            <div class="max-w-7xl mx-auto flex items-center justify-between flex-wrap gap-4">
                <div class="flex items-center gap-3">
                    <svg class="w-6 h-6 text-[var(--primary)]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="font-semibold text-[var(--foreground)]">Save your progress</p>
                        <p class="text-sm text-[var(--muted-foreground)]">Sign up to sync your portfolio across devices and never lose your data</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <button class="google-signin-btn bg-[var(--primary)] text-[var(--primary-foreground)] border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all">
                        Sign Up Free
                    </button>
                    <button id="dismiss-guest-prompt-btn" class="bg-[var(--muted)] text-[var(--foreground)] border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all">
                        Maybe Later
                    </button>
                </div>
            </div>
        </div>

        <!-- Add Purchase Form -->
        <section id="add-purchase-section" class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Add Stock Purchase</h2>

            <!-- Tab Navigation -->
            <div class="flex border-b border-gray-200 mb-4">
                <button type="button" id="tab-quick-add"
                        class="px-4 py-2 text-sm font-medium text-[var(--primary)] border-b-2 border-[var(--primary)] -mb-px">
                    Quick Add
                </button>
                <button type="button" id="tab-detailed-entry"
                        class="px-4 py-2 text-sm font-medium text-[var(--muted-foreground)] hover:text-[var(--foreground)] border-b-2 border-transparent -mb-px">
                    Detailed Entry
                </button>
                <button type="button" id="tab-pdf-upload"
                        class="px-4 py-2 text-sm font-medium text-[var(--muted-foreground)] hover:text-[var(--foreground)] border-b-2 border-transparent -mb-px">
                    PDF Upload
                </button>
            </div>

            <!-- Quick Add Panel -->
            <div id="panel-quick-add">
                <form id="purchase-form-quick" class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label for="ticker-quick" class="block text-sm font-medium text-gray-700 mb-1">Stock Ticker</label>
                        <input type="text" id="ticker-quick" name="ticker" required
                               class="w-full px-4 py-2 border-2 border-[var(--border)] rounded shadow-md focus:outline-none focus:shadow-sm transition-all"
                               placeholder="e.g., TSLA">
                    </div>
                    <div>
                        <label for="purchase-date-quick" class="block text-sm font-medium text-gray-700 mb-1">Purchase Date</label>
                        <input type="date" id="purchase-date-quick" name="purchase_date" required
                               class="w-full px-4 py-2 border-2 border-[var(--border)] rounded shadow-md focus:outline-none focus:shadow-sm transition-all">
                    </div>
                    <div>
                        <label for="amount-quick" class="block text-sm font-medium text-gray-700 mb-1">Total Investment ($)</label>
                        <input type="number" id="amount-quick" name="amount" min="0.01" step="0.01" required
                               class="w-full px-4 py-2 border-2 border-[var(--border)] rounded shadow-md focus:outline-none focus:shadow-sm transition-all"
                               placeholder="1000.00">
                    </div>
                    <div class="flex items-end">
                        <button type="submit" id="submit-btn-quick"
                                class="w-full bg-[var(--primary)] text-[var(--primary-foreground)] border-2 border-[var(--border)] py-2 px-4 rounded shadow-md hover:shadow-none hover:translate-y-0.5 active:translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                            Add Purchase
                        </button>
                    </div>
                </form>
                <p class="text-sm text-gray-500 mt-2">Price will be automatically fetched from market data.</p>
            </div>

            <!-- Detailed Entry Panel -->
            <div id="panel-detailed-entry" class="hidden">
                <form id="purchase-form-detailed" class="grid grid-cols-1 md:grid-cols-5 gap-4">
                    <div>
                        <label for="ticker-detailed" class="block text-sm font-medium text-gray-700 mb-1">Stock Ticker</label>
                        <input type="text" id="ticker-detailed" name="ticker" required
                               class="w-full px-4 py-2 border-2 border-[var(--border)] rounded shadow-md focus:outline-none focus:shadow-sm transition-all"
                               placeholder="e.g., TSLA">
                    </div>
                    <div>
                        <label for="purchase-date-detailed" class="block text-sm font-medium text-gray-700 mb-1">Purchase Date</label>
                        <input type="date" id="purchase-date-detailed" name="purchase_date" required
                               class="w-full px-4 py-2 border-2 border-[var(--border)] rounded shadow-md focus:outline-none focus:shadow-sm transition-all">
                    </div>
                    <div>
                        <label for="quantity-detailed" class="block text-sm font-medium text-gray-700 mb-1">Shares</label>
                        <input type="number" id="quantity-detailed" name="quantity" min="0.0001" step="0.0001" required
                               class="w-full px-4 py-2 border-2 border-[var(--border)] rounded shadow-md focus:outline-none focus:shadow-sm transition-all"
                               placeholder="10.5">
                    </div>
                    <div>
                        <label for="price-detailed" class="block text-sm font-medium text-gray-700 mb-1">Price per Share ($)</label>
                        <input type="number" id="price-detailed" name="price_per_share" min="0.01" step="0.01" required
                               class="w-full px-4 py-2 border-2 border-[var(--border)] rounded shadow-md focus:outline-none focus:shadow-sm transition-all"
                               placeholder="150.00">
                    </div>
                    <div class="flex items-end">
                        <button type="submit" id="submit-btn-detailed"
                                class="w-full bg-[var(--primary)] text-[var(--primary-foreground)] border-2 border-[var(--border)] py-2 px-4 rounded shadow-md hover:shadow-none hover:translate-y-0.5 active:translate-y-1 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                            Add Purchase
                        </button>
                    </div>
                </form>
                <p class="text-sm text-gray-600 mt-2">
                    Total: <span id="calculated-amount" class="font-semibold">$0.00</span>
                    <span class="text-gray-500 ml-2">(shares Ã— price)</span>
                </p>
            </div>

            <!-- PDF Upload Panel -->
            <div id="panel-pdf-upload" class="hidden">
                <div id="pdf-drop-zone" class="border-2 border-dashed border-[var(--border)] rounded-lg p-8 text-center cursor-pointer hover:border-[var(--primary)] hover:bg-[var(--primary)]/5 transition-all">
                    <input type="file" id="pdf-file-input" accept=".pdf" class="hidden">
                    <label for="pdf-file-input" class="cursor-pointer block">
                        <svg class="w-12 h-12 mx-auto text-[var(--muted-foreground)] mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                        </svg>
                        <span class="text-[var(--foreground)] font-medium">Click to upload PDF</span>
                        <span class="block text-sm text-[var(--muted-foreground)] mt-1">or drag and drop</span>
                    </label>
                    <p class="text-xs text-[var(--muted-foreground)] mt-4">
                        Supports brokerage statements from most brokers (max 10MB)
                    </p>
                </div>
                <div id="pdf-upload-status" class="hidden mt-4 p-3 rounded border-2"></div>
            </div>

            <div id="form-error" class="hidden mt-3 p-3 bg-red-100 border-2 border-[var(--destructive)] text-red-700 rounded"></div>
            <div id="form-success" class="hidden mt-3 p-3 bg-green-100 border-2 border-[var(--success)] text-green-700 rounded"></div>
        </section>

        <!-- Summary Cards Skeleton -->
        <section id="summary-skeleton" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8 hidden">
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 animate-pulse">
                <div class="h-4 bg-gray-200 rounded w-24 mb-3"></div>
                <div class="h-8 bg-gray-200 rounded w-32"></div>
            </div>
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 animate-pulse">
                <div class="h-4 bg-gray-200 rounded w-32 mb-3"></div>
                <div class="h-8 bg-gray-200 rounded w-28 mb-2"></div>
                <div class="h-3 bg-gray-200 rounded w-24"></div>
            </div>
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 animate-pulse">
                <div class="h-4 bg-gray-200 rounded w-28 mb-3"></div>
                <div class="h-8 bg-gray-200 rounded w-28 mb-2"></div>
                <div class="h-3 bg-gray-200 rounded w-20"></div>
            </div>
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 animate-pulse">
                <div class="h-4 bg-gray-200 rounded w-32 mb-3"></div>
                <div class="h-8 bg-gray-200 rounded w-28 mb-2"></div>
                <div class="h-3 bg-gray-200 rounded w-36"></div>
            </div>
        </section>

        <!-- Summary Cards -->
        <section id="summary-section" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8 hidden">
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6">
                <h3 class="text-sm font-medium text-gray-500">Total Invested</h3>
                <p id="total-invested" class="text-2xl font-bold text-gray-800">$0.00</p>
            </div>
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6">
                <h3 class="text-sm font-medium text-gray-500">Your Portfolio Value</h3>
                <p id="actual-value" class="text-2xl font-bold text-gray-800">$0.00</p>
                <p id="actual-return" class="text-sm text-gray-500"></p>
            </div>
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6">
                <h3 class="text-sm font-medium text-gray-500">Best Alternative</h3>
                <p id="best-alt-value" class="text-2xl font-bold text-green-600">$0.00</p>
                <p id="best-alt-name" class="text-sm text-gray-500"></p>
            </div>
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6">
                <h3 class="text-sm font-medium text-gray-500">Opportunity Cost</h3>
                <p id="opportunity-cost" class="text-2xl font-bold text-red-600">$0.00</p>
                <p id="opportunity-cost-desc" class="text-sm text-gray-500"></p>
            </div>
        </section>

        <!-- Share Button (shown when there's data) -->
        <div id="share-button-section" class="hidden mb-8 flex justify-end">
            <button id="share-results-btn"
                    class="inline-flex items-center gap-2 bg-[var(--primary)] text-[var(--primary-foreground)] border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                </svg>
                Share Results
            </button>
        </div>

        <!-- Chart Skeleton -->
        <section id="chart-skeleton" class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 mb-8 hidden">
            <div class="h-6 bg-gray-200 rounded w-64 mb-4 animate-pulse"></div>
            <div class="animate-pulse">
                <div class="h-64 bg-gray-200 rounded"></div>
            </div>
        </section>

        <!-- Chart -->
        <section id="chart-section" class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 mb-8 hidden">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Portfolio Performance Over Time</h2>
            <div id="chart-loading" class="text-center py-8 text-gray-500">
                <p>Add a purchase to see the chart</p>
            </div>
            <canvas id="portfolio-chart" class="hidden"></canvas>
            <div id="chart-legend" class="mt-4 flex flex-wrap gap-2 justify-center"></div>
        </section>

        <!-- Comparison Table -->
        <section id="table-section" class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Detailed Comparison</h2>
            <div class="overflow-x-auto">
                <table id="comparison-table" class="min-w-full border-2 border-[var(--border)] shadow-lg">
                    <thead class="bg-[var(--primary)] text-[var(--primary-foreground)]">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Stock</th>
                            <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Invested</th>
                            <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Current Value</th>
                            <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Gain/Loss</th>
                            <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Return %</th>
                        </tr>
                    </thead>
                    <tbody id="comparison-tbody" class="bg-white divide-y divide-gray-200">
                        <tr class="border-b border-[var(--border)] hover:bg-[var(--primary)]/10 transition-colors">
                            <td colspan="5" class="px-6 py-4 text-center text-gray-500">No purchases yet</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Purchases List Skeleton -->
        <section id="purchases-skeleton" class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 hidden">
            <div class="h-6 bg-gray-200 rounded w-40 mb-4 animate-pulse"></div>
            <div class="space-y-2">
                <div class="animate-pulse bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <div class="h-5 bg-gray-200 rounded w-24 mb-2"></div>
                            <div class="h-4 bg-gray-200 rounded w-32"></div>
                        </div>
                        <div class="flex items-center gap-4">
                            <div class="h-4 bg-gray-200 rounded w-20"></div>
                            <div class="h-4 bg-gray-200 rounded w-32"></div>
                        </div>
                    </div>
                </div>
                <div class="animate-pulse bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <div class="h-5 bg-gray-200 rounded w-28 mb-2"></div>
                            <div class="h-4 bg-gray-200 rounded w-36"></div>
                        </div>
                        <div class="flex items-center gap-4">
                            <div class="h-4 bg-gray-200 rounded w-24"></div>
                            <div class="h-4 bg-gray-200 rounded w-28"></div>
                        </div>
                    </div>
                </div>
                <div class="animate-pulse bg-gray-50 rounded-lg p-3">
                    <div class="flex items-center justify-between">
                        <div class="flex-1">
                            <div class="h-5 bg-gray-200 rounded w-20 mb-2"></div>
                            <div class="h-4 bg-gray-200 rounded w-40"></div>
                        </div>
                        <div class="flex items-center gap-4">
                            <div class="h-4 bg-gray-200 rounded w-28"></div>
                            <div class="h-4 bg-gray-200 rounded w-36"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Purchases List -->
        <section id="purchases-section" class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 hidden">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Your Purchases</h2>
            <div id="purchases-list" class="space-y-2">
                <p class="text-gray-500">No purchases yet</p>
            </div>
        </section>

        <!-- Purchase Detail View (hidden by default) -->
        <section id="purchase-detail-section" class="hidden">
            <!-- Back Button -->
            <button id="navigate-back-btn"
                    class="flex items-center text-blue-600 hover:text-blue-800 mb-4 font-medium">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
                Back to Portfolio
            </button>

            <!-- Loading State -->
            <div id="detail-loading" class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6 text-center">
                <p class="text-gray-500">Loading purchase details...</p>
            </div>

            <!-- Error State -->
            <div id="detail-error" class="hidden p-3 bg-red-100 border-2 border-[var(--destructive)] text-red-700 rounded mb-4">
            </div>

            <!-- Detail Content -->
            <div id="detail-content" class="hidden space-y-6">
                <!-- Purchase Header -->
                <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6">
                    <h2 class="text-2xl font-bold text-gray-800">
                        <span id="detail-ticker"></span>
                        <span class="text-gray-500 text-lg font-normal ml-2">purchased on <span id="detail-date"></span></span>
                    </h2>
                    <div class="mt-4 grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div>
                            <p class="text-sm text-gray-500">Amount Invested</p>
                            <p id="detail-amount" class="text-xl font-semibold text-gray-800"></p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Shares Bought</p>
                            <p id="detail-shares" class="text-xl font-semibold text-gray-800"></p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Price at Purchase</p>
                            <p id="detail-price-at-purchase" class="text-xl font-semibold text-gray-800"></p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Current Value</p>
                            <p id="detail-current-value" class="text-xl font-semibold text-gray-800"></p>
                            <p id="detail-return" class="text-sm"></p>
                        </div>
                    </div>
                </div>

                <!-- "What If" Comparison Cards -->
                <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">If you had bought instead...</h3>
                    <div id="detail-alternatives" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Alternative cards rendered here -->
                    </div>
                </div>

                <!-- Historical Chart -->
                <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Performance Over Time</h3>
                    <canvas id="detail-chart"></canvas>
                </div>

                <!-- Detailed Comparison Table -->
                <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-md hover:shadow-none transition-all p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4">Detailed Comparison</h3>
                    <div class="overflow-x-auto">
                        <table class="min-w-full border-2 border-[var(--border)] shadow-lg">
                            <thead class="bg-[var(--primary)] text-[var(--primary-foreground)]">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium uppercase tracking-wider">Stock</th>
                                    <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Price Then</th>
                                    <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Shares</th>
                                    <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Price Now</th>
                                    <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Value Now</th>
                                    <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">Return</th>
                                    <th class="px-6 py-3 text-right text-xs font-medium uppercase tracking-wider">vs Your Pick</th>
                                </tr>
                            </thead>
                            <tbody id="detail-comparison-tbody" class="divide-y divide-gray-200">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="fixed top-4 right-4 z-50 flex flex-col gap-3 pointer-events-none"></div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="fixed inset-0 z-50 hidden">
        <!-- Backdrop -->
        <div class="fixed inset-0 bg-black/50 backdrop-blur-sm" id="modal-backdrop"></div>
        <!-- Modal Content -->
        <div class="fixed inset-0 flex items-center justify-center p-4">
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-xl max-w-md w-full p-6 relative" id="modal-content">
                <div class="flex items-start gap-4">
                    <div id="modal-icon" class="flex-shrink-0 w-10 h-10 rounded-full bg-red-100 flex items-center justify-center">
                        <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </svg>
                    </div>
                    <div class="flex-1">
                        <h3 id="modal-title" class="text-lg font-semibold text-gray-900">Confirm Action</h3>
                        <p id="modal-message" class="mt-2 text-sm text-gray-600">Are you sure you want to proceed?</p>
                    </div>
                </div>
                <div class="mt-6 flex justify-end gap-3">
                    <button id="modal-cancel" class="bg-[var(--muted)] text-[var(--foreground)] border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all">
                        Cancel
                    </button>
                    <button id="modal-confirm" class="bg-[var(--destructive)] text-white border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all">
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="share-modal" class="fixed inset-0 z-50 hidden">
        <!-- Backdrop -->
        <div id="share-modal-backdrop" class="fixed inset-0 bg-black/50 backdrop-blur-sm"></div>
        <!-- Modal Content -->
        <div class="fixed inset-0 flex items-center justify-center p-4">
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-xl max-w-lg w-full p-6 relative">
                <!-- Close Button -->
                <button id="share-modal-close-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>

                <h3 class="text-xl font-semibold text-gray-900 mb-4">Share Your Portfolio Performance</h3>

                <!-- Preview Card -->
                <div id="share-preview" class="border border-gray-200 rounded-lg p-4 mb-6 bg-gray-50">
                    <p class="text-gray-500 text-center">Loading preview...</p>
                </div>

                <!-- Share Options -->
                <div class="space-y-4">
                    <!-- Download PNG -->
                    <button id="download-share-btn"
                            class="w-full flex items-center justify-center gap-2 bg-gray-800 text-white border-2 border-[var(--border)] py-3 px-4 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                        </svg>
                        Download as PNG
                    </button>

                    <!-- Copy Link -->
                    <div class="flex gap-2">
                        <input type="text" id="share-url" readonly
                               class="flex-1 px-4 py-2 border-2 border-[var(--border)] rounded shadow-md focus:outline-none focus:shadow-sm transition-all bg-gray-50 text-gray-600 text-sm"
                               placeholder="Creating share link...">
                        <button id="copy-share-link-btn"
                                class="bg-[var(--primary)] text-[var(--primary-foreground)] border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all flex items-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                            Copy
                        </button>
                    </div>
                </div>

                <p class="text-xs text-gray-500 mt-4 text-center">
                    Your share link shows percentages only - no dollar amounts are shared.
                </p>
            </div>
        </div>
    </div>

    <!-- PDF Trade Confirmation Modal -->
    <div id="pdf-confirm-modal" class="fixed inset-0 z-50 hidden">
        <div id="pdf-modal-backdrop" class="fixed inset-0 bg-black/50 backdrop-blur-sm"></div>
        <div class="fixed inset-0 flex items-center justify-center p-4 overflow-y-auto">
            <div class="bg-[var(--card)] border-2 border-[var(--border)] rounded shadow-xl max-w-4xl w-full p-6 relative max-h-[90vh] overflow-y-auto">
                <button id="pdf-modal-close" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">Review Extracted Trades</h3>
                <p class="text-sm text-[var(--muted-foreground)] mb-4">
                    Review the trades extracted from your PDF. You can edit values before saving.
                </p>
                <div id="pdf-extraction-notes" class="hidden mb-4 p-3 bg-yellow-50 border-2 border-yellow-200 rounded text-sm"></div>
                <div class="overflow-x-auto">
                    <table class="min-w-full border-2 border-[var(--border)]">
                        <thead class="bg-[var(--primary)] text-[var(--primary-foreground)]">
                            <tr>
                                <th class="px-3 py-2 text-left text-xs font-medium uppercase">
                                    <input type="checkbox" id="pdf-select-all" class="w-4 h-4">
                                </th>
                                <th class="px-3 py-2 text-left text-xs font-medium uppercase">Ticker</th>
                                <th class="px-3 py-2 text-left text-xs font-medium uppercase">Date</th>
                                <th class="px-3 py-2 text-right text-xs font-medium uppercase">Shares</th>
                                <th class="px-3 py-2 text-right text-xs font-medium uppercase">Price</th>
                                <th class="px-3 py-2 text-right text-xs font-medium uppercase">Total</th>
                                <th class="px-3 py-2 text-center text-xs font-medium uppercase">Status</th>
                            </tr>
                        </thead>
                        <tbody id="pdf-trades-tbody" class="divide-y divide-gray-200 bg-white"></tbody>
                    </table>
                </div>
                <div class="mt-4 flex justify-between items-center">
                    <div class="text-sm text-[var(--muted-foreground)]">
                        <span id="pdf-selected-count">0</span> of <span id="pdf-total-count">0</span> trades selected
                    </div>
                    <div class="flex gap-3">
                        <button id="pdf-cancel-btn" class="bg-[var(--muted)] text-[var(--foreground)] border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all">
                            Cancel
                        </button>
                        <button id="pdf-save-btn" class="bg-[var(--primary)] text-[var(--primary-foreground)] border-2 border-[var(--border)] px-4 py-2 rounded shadow-md hover:shadow-none hover:translate-y-0.5 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                            Save Selected Trades
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/static/js/guest.js"></script>
    <script src="/static/js/auth.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
